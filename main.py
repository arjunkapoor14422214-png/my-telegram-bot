import os
import time
import telebot
from telebot import types
from flask import Flask
import telebot.apihelper

# ╨Э╨░╤Б╤В╤А╨╛╨╣╨║╨╕ telebot: ╨┐╨╡╤А╨╕╨╛╨┤ ╨╢╨╕╨╖╨╜╨╕ ╤Б╨╡╤Б╤Б╨╕╨╕ (╤Г╨╝╨╡╨╜╤М╤И╨░╨╡╤В ╤И╨░╨╜╤Б╤Л ╨╜╨░ ConnectionError)
telebot.apihelper.SESSION_TIME_TO_LIVE = 5

# Flask app (╨╛╨┤╨╕╨╜ ╤Н╨║╨╖╨╡╨╝╨┐╨╗╤П╤А)
app = Flask(__name__)

@app.route('/')
def index():
    return '╨С╨╛╤В ╤А╨░╨▒╨╛╤В╨░╨╡╤В!'

# ╨С╨╡╤А╤С╨╝ ╤В╨╛╨║╨╡╨╜ ╨╕╨╖ ╨┐╨╡╤А╨╡╨╝╨╡╨╜╨╜╤Л╤Е ╨╛╨║╤А╤Г╨╢╨╡╨╜╨╕╤П
BOT_TOKEN = os.getenv("BOT_TOKEN")
if not BOT_TOKEN:
    raise ValueError("╨Ю╤И╨╕╨▒╨║╨░: ╨┐╨╡╤А╨╡╨╝╨╡╨╜╨╜╨░╤П ╨╛╨║╤А╤Г╨╢╨╡╨╜╨╕╤П BOT_TOKEN ╨╜╨╡ ╨╖╨░╨┤╨░╨╜╨░!")

# ╨Ш╨╜╨╕╤Ж╨╕╨░╨╗╨╕╨╖╨░╤Ж╨╕╤П ╨▒╨╛╤В╨░
bot = telebot.TeleBot(BOT_TOKEN)

# ╨б╨╗╨╛╨▓╨░╤А╤М ╨┤╨╗╤П ╤Е╤А╨░╨╜╨╡╨╜╨╕╤П ╨▓╤Л╨▒╤А╨░╨╜╨╜╨╛╨│╨╛ ╤П╨╖╤Л╨║╨░ ╨┐╨╛╨╗╤М╨╖╨╛╨▓╨░╤В╨╡╨╗╤П╨╝╨╕ (╨▓ ╨┐╨░╨╝╤П╤В╨╕)
user_language = {}


LANGS = {
    "EN": "ЁЯЗмЁЯЗз English",
    "RU": "ЁЯЗ╖ЁЯЗ║ ╨а╤Г╤Б╤Б╨║╨╕╨╣",
    "AR": "ЁЯЗ╕ЁЯЗж ╪з┘Д╪╣╪▒╪и┘К╪й",
    "HI": "ЁЯЗоЁЯЗ│ рд╣рд┐рдВрджреА",
    "BN": "ЁЯЗзЁЯЗй ржмрж╛ржВрж▓рж╛"
}

# ╨в╨╡╨║╤Б╤В╤Л
TEXTS = {
    "start": {
        "EN": "Choose your language ЁЯМР",
        "RU": "╨Т╤Л╨▒╨╡╤А╨╕╤В╨╡ ╤Б╨▓╨╛╨╣ ╤П╨╖╤Л╨║ ЁЯМР",
        "AR": "╪з╪о╪к╪▒ ┘Д╪║╪к┘Г ЁЯМР",
        "HI": "рдЕрдкрдиреА рднрд╛рд╖рд╛ рдЪреБрдиреЗрдВ ЁЯМР",
        "BN": "ржЖржкржирж╛рж░ ржнрж╛рж╖рж╛ ржмрзЗржЫрзЗ ржирж┐ржи ЁЯМР",
    },

    "menu": {
        "EN": "Please choose an option:",
        "RU": "╨Я╨╛╨╢╨░╨╗╤Г╨╣╤Б╤В╨░, ╨▓╤Л╨▒╨╡╤А╨╕╤В╨╡ ╨┤╨╡╨╣╤Б╤В╨▓╨╕╨╡:",
        "AR": "┘К╪▒╪м┘Й ╪з╪о╪к┘К╪з╪▒ ╪о┘К╪з╪▒:",
        "HI": "рдХреГрдкрдпрд╛ рд╡рд┐рдХрд▓реНрдк рдЪреБрдиреЗрдВ:",
        "BN": "ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржПржХржЯрж┐ ржмрж┐ржХрж▓рзНржк ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи:",
    },

    "partner": {
        "EN": """Contact our manager to discuss the details of the cooperation.
@username""",

        "RU": """╨б╨▓╤П╨╢╨╕╤В╨╡╤Б╤М ╤Б ╨╜╨░╤И╨╕╨╝ ╨╝╨╡╨╜╨╡╨┤╨╢╨╡╤А╨╛╨╝, ╤З╤В╨╛╨▒╤Л ╨╛╨▒╤Б╤Г╨┤╨╕╤В╤М ╨┤╨╡╤В╨░╨╗╨╕ ╤Б╨╛╤В╤А╤Г╨┤╨╜╨╕╤З╨╡╤Б╤В╨▓╨░.
@username""",

        "AR": """╪к┘И╪з╪╡┘Д ┘Е╪╣ ┘Е╪п┘К╪▒┘Ж╪з ┘Д┘Е┘Ж╪з┘В╪┤╪й ╪к┘Б╪з╪╡┘К┘Д ╪з┘Д╪к╪╣╪з┘И┘Ж.
@username""",

        "HI": """рд╕рд╣рдпреЛрдЧ рдХреЗ рд╡рд┐рд╡рд░рдг рдкрд░ рдЪрд░реНрдЪрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░реЗ рдореИрдиреЗрдЬрд░ рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░реЗрдВред
@username""",

        "BN": """рж╕рж╣ржпрзЛржЧрж┐рждрж╛рж░ ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд ржЖрж▓рзЛржЪржирж╛ ржХрж░рждрзЗ ржЖржорж╛ржжрзЗрж░ ржорзНржпрж╛ржирзЗржЬрж╛рж░рзЗрж░ рж╕рж╛ржерзЗ ржпрзЛржЧрж╛ржпрзЛржЧ ржХрж░рзБржиред
@username"""
    },

    "agent_choose": {
        "EN": "Choose agent type:",
        "RU": "╨Т╤Л╨▒╨╡╤А╨╕╤В╨╡ ╤В╨╕╨┐ ╨░╨│╨╡╨╜╤В╨░:",
        "AR": "╪з╪о╪к╪▒ ┘Ж┘И╪╣ ╪з┘Д┘И┘Г┘К┘Д:",
        "HI": "рдПрдЬреЗрдВрдЯ рдкреНрд░рдХрд╛рд░ рдЪреБрдиреЗрдВ:",
        "BN": "ржПржЬрзЗржирзНржЯрзЗрж░ ржзрж░ржи ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи:",
    },

    "agent_bank": {
        "EN": """Please provide the following information:

1. Full name:
2. Date of birth:
3. NID number:
4. Current location:
5. Wallets (geos) for payments:
6. List of banks you can provide:
7. Ready for advance payment in two parts:
8. Ensure 24/7 availability:
9. Attach photos of your ID card and a selfie.
ID card number:

Send this information to: @""",

        "RU": """╨Я╨╛╨╢╨░╨╗╤Г╨╣╤Б╤В╨░, ╨┐╤А╨╡╨┤╨╛╤Б╤В╨░╨▓╤М╤В╨╡ ╤Б╨╗╨╡╨┤╤Г╤О╤Й╤Г╤О ╨╕╨╜╤Д╨╛╤А╨╝╨░╤Ж╨╕╤О:

1. ╨д╨Ш╨Ю:
2. ╨Ф╨░╤В╨░ ╤А╨╛╨╢╨┤╨╡╨╜╨╕╤П:
3. ╨Э╨╛╨╝╨╡╤А NID:
4. ╨в╨╡╨║╤Г╤Й╨╡╨╡ ╨╝╨╡╤Б╤В╨╛╨┐╨╛╨╗╨╛╨╢╨╡╨╜╨╕╨╡:
5. ╨Ъ╨╛╤И╨╡╨╗╤М╨║╨╕ ╨┤╨╗╤П ╨┐╨╗╨░╤В╨╡╨╢╨╡╨╣:
6. ╨б╨┐╨╕╤Б╨╛╨║ ╨▒╨░╨╜╨║╨╛╨▓, ╨║╨╛╤В╨╛╤А╤Л╨╡ ╨▓╤Л ╨╝╨╛╨╢╨╡╤В╨╡ ╨┐╤А╨╡╨┤╨╛╤Б╤В╨░╨▓╨╕╤В╤М:
7. ╨У╨╛╤В╨╛╨▓╤Л ╤Б╨┤╨╡╨╗╨░╤В╤М ╨┐╤А╨╡╨┤╨╛╨┐╨╗╨░╤В╤Г ╨▓ ╨┤╨▓╨░ ╤Н╤В╨░╨┐╨░:
8. ╨Ю╨▒╨╡╤Б╨┐╨╡╤З╤М╤В╨╡ ╨┤╨╛╤Б╤В╤Г╨┐╨╜╨╛╤Б╤В╤М 24/7:
9. ╨Я╤А╨╕╨║╤А╨╡╨┐╨╕╤В╨╡ ╤Д╨╛╤В╨╛╨│╤А╨░╤Д╨╕╨╕ ╨▓╨░╤И╨╡╨│╨╛ ╤Г╨┤╨╛╤Б╤В╨╛╨▓╨╡╤А╨╡╨╜╨╕╤П ╨╗╨╕╤З╨╜╨╛╤Б╤В╨╕ ╨╕ ╤Б╨╡╨╗╤Д╨╕.
╨Э╨╛╨╝╨╡╤А ╤Г╨┤╨╛╤Б╤В╨╛╨▓╨╡╤А╨╡╨╜╨╕╤П ╨╗╨╕╤З╨╜╨╛╤Б╤В╨╕:

╨Ю╤В╨┐╤А╨░╨▓╤М╤В╨╡ ╤Н╤В╤Г ╨╕╨╜╤Д╨╛╤А╨╝╨░╤Ж╨╕╤О: @""",

        "AR": """┘К╪▒╪м┘Й ╪к┘В╪п┘К┘Е ╪з┘Д┘Е╪╣┘Д┘И┘Е╪з╪к ╪з┘Д╪к╪з┘Д┘К╪й:

1. ╪з┘Д╪з╪│┘Е ╪з┘Д┘Г╪з┘Е┘Д:
2. ╪к╪з╪▒┘К╪о ╪з┘Д┘Е┘К┘Д╪з╪п:
3. ╪▒┘В┘Е ╪з┘Д┘З┘И┘К╪й:
4. ╪з┘Д┘Е┘И┘В╪╣ ╪з┘Д╪н╪з┘Д┘К:
5. ╪з┘Д┘Е╪н╪з┘Б╪╕ ┘Д┘Д┘Е╪п┘Б┘И╪╣╪з╪к:
6. ┘В╪з╪ж┘Е╪й ╪з┘Д╪и┘Ж┘И┘Г ╪з┘Д╪к┘К ┘К┘Е┘Г┘Ж┘Г ╪к┘В╪п┘К┘Е┘З╪з:
7. ┘З┘Д ╪г┘Ж╪к ┘Е╪│╪к╪╣╪п ┘Д┘Д╪п┘Б╪╣ ╪з┘Д┘Е╪│╪и┘В ╪╣┘Д┘Й ╪м╪▓╪г┘К┘Ж:
8. ╪╢┘Е╪з┘Ж ╪з┘Д╪к┘И┘Б╪▒ 24/7:
9. ╪г╪▒┘Б┘В ╪╡┘И╪▒ ╪и╪╖╪з┘В╪й ╪з┘Д┘З┘И┘К╪й ╪з┘Д╪о╪з╪╡╪й ╪и┘Г ┘И╪╡┘И╪▒╪й ╪│┘К┘Д┘Б┘К.
╪▒┘В┘Е ╪и╪╖╪з┘В╪й ╪з┘Д┘З┘И┘К╪й:

╪г╪▒╪│┘Д ┘З╪░┘З ╪з┘Д┘Е╪╣┘Д┘И┘Е╪з╪к ╪е┘Д┘Й: @""",

        "HI": """рдХреГрдкрдпрд╛ рдирд┐рдореНрди рдЬрд╛рдирдХрд╛рд░реА рджреЗрдВ:

1. рдкреВрд░рд╛ рдирд╛рдо:
2. рдЬрдиреНрдо рддрд┐рдерд┐:
3. NID рдирдВрдмрд░:
4. рд╡рд░реНрддрдорд╛рди рд╕реНрдерд╛рди:
5. рднреБрдЧрддрд╛рди рдХреЗ рд▓рд┐рдП рд╡реЙрд▓реЗрдЯреНрд╕:
6. рд╡реЗ рдмреИрдВрдХ рдЬрд┐рдирдХреА рдЖрдк рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
7. рджреЛ рд╣рд┐рд╕реНрд╕реЛрдВ рдореЗрдВ рдЕрдЧреНрд░рд┐рдо рднреБрдЧрддрд╛рди рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░:
8. 24/7 рдЙрдкрд▓рдмреНрдзрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ:
9. рдЕрдкрдиреА рдкрд╣рдЪрд╛рди рдкрддреНрд░ рдХреА рддрд╕реНрд╡реАрд░реЗрдВ рдФрд░ рдПрдХ рд╕реЗрд▓реНрдлреА рд╕рдВрд▓рдЧреНрди рдХрд░реЗрдВред
рдкрд╣рдЪрд╛рди рдкрддреНрд░ рд╕рдВрдЦреНрдпрд╛:

рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рднреЗрдЬреЗрдВ: @""",

        "BN": """ржЕржирзБржЧрзНрж░рж╣ ржХрж░рзЗ ржирж┐ржорзНржирж▓рж┐ржЦрж┐ржд рждржерзНржп ржкрзНрж░ржжрж╛ржи ржХрж░рзБржи:

1. ржкрзБрж░рзЛ ржирж╛ржо:
2. ржЬржирзНржо рждрж╛рж░рж┐ржЦ:
3. NID ржиржорзНржмрж░:
4. ржмрж░рзНрждржорж╛ржи ржЕржмрж╕рзНржерж╛ржи:
5. ржкрзЗржорзЗржирзНржЯрзЗрж░ ржЬржирзНржп ржУржпрж╝рж╛рж▓рзЗржЯ:
6. ржпрзЗ ржмрзНржпрж╛ржВржХржЧрзБрж▓рзЛрж░ рждржерзНржп ржЖржкржирж┐ ржжрж┐рждрзЗ ржкрж╛рж░рзЗржи рждрж╛рж░ рждрж╛рж▓рж┐ржХрж╛:
7. ржжрзБржЗ ржЕржВрж╢рзЗ ржЕржЧрзНрж░рж┐ржо ржкрзНрж░ржжрж╛ржирзЗрж░ ржЬржирзНржп ржкрзНрж░рж╕рзНрждрзБржд:
8. 24/7 ржЙржкрж▓ржмрзНржзрждрж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзБржи:
9. ржЖржкржирж╛рж░ ржЖржЗржбрж┐ ржХрж╛рж░рзНржбрзЗрж░ ржЫржмрж┐ ржПржмржВ ржПржХржЯрж┐ рж╕рзЗрж▓ржлрж┐ рж╕ржВржпрзБржХрзНржд ржХрж░рзБржиред
ржЖржЗржбрж┐ ржХрж╛рж░рзНржб ржиржорзНржмрж░:

ржПржЗ рждржерзНржп ржкрж╛ржарж╛ржи: @""",
    },

    "agent_mobcash": {
        "EN": """Hello! Fill out the form to create MobCash account:
1. Full name:
2. Date of birth:
3. ID card number:
4. Current location:
5. Attach photos of your ID card and a selfie.

Then send your account ID to your manager or main manager.
Telegram: @""",

        "RU": """╨Ч╨┤╤А╨░╨▓╤Б╤В╨▓╤Г╨╣╤В╨╡! ╨Ч╨░╨┐╨╛╨╗╨╜╨╕╤В╨╡ ╤Д╨╛╤А╨╝╤Г ╨┤╨╗╤П ╤Б╨╛╨╖╨┤╨░╨╜╨╕╤П ╨░╨║╨║╨░╤Г╨╜╤В╨░ MobCash:
1. ╨д╨Ш╨Ю:
2. ╨Ф╨░╤В╨░ ╤А╨╛╨╢╨┤╨╡╨╜╨╕╤П:
3. ╨Э╨╛╨╝╨╡╤А ╤Г╨┤╨╛╤Б╤В╨╛╨▓╨╡╤А╨╡╨╜╨╕╤П ╨╗╨╕╤З╨╜╨╛╤Б╤В╨╕:
4. ╨в╨╡╨║╤Г╤Й╨╡╨╡ ╨╝╨╡╤Б╤В╨╛╨┐╨╛╨╗╨╛╨╢╨╡╨╜╨╕╨╡:
5. ╨Я╤А╨╕╨║╤А╨╡╨┐╨╕╤В╨╡ ╤Д╨╛╤В╨╛╨│╤А╨░╤Д╨╕╨╕ ╤Г╨┤╨╛╤Б╤В╨╛╨▓╨╡╤А╨╡╨╜╨╕╤П ╨╗╨╕╤З╨╜╨╛╤Б╤В╨╕ ╨╕ ╤Б╨╡╨╗╤Д╨╕.

╨Ч╨░╤В╨╡╨╝ ╨╛╤В╨┐╤А╨░╨▓╤М╤В╨╡ ID ╨░╨║╨║╨░╤Г╨╜╤В╨░ ╨▓╨░╤И╨╡╨╝╤Г ╨╝╨╡╨╜╨╡╨┤╨╢╨╡╤А╤Г ╨╕╨╗╨╕ ╨│╨╗╨░╨▓╨╜╨╛╨╝╤Г ╨╝╨╡╨╜╨╡╨┤╨╢╨╡╤А╤Г.
Telegram: @""",
        
        "AR": ┘Е╪▒╪н╪и╪з┘Л! ╪з┘Е┘Д╪г ╪з┘Д┘Ж┘Е┘И╪░╪м ┘Д╪е┘Ж╪┤╪з╪б ╪н╪│╪з╪и ┘Е┘И╪и ┘Г╪з╪┤:
1. ╪з┘Д╪з╪│┘Е ╪з┘Д┘Г╪з┘Е┘Д:
2. ╪к╪з╪▒┘К╪о ╪з┘Д┘Е┘К┘Д╪з╪п:
3. ╪▒┘В┘Е ╪и╪╖╪з┘В╪й ╪з┘Д┘З┘И┘К╪й:
4. ╪з┘Д┘Е┘И┘В╪╣ ╪з┘Д╪н╪з┘Д┘К:
5. ╪г╪▒┘Б┘В ╪╡┘И╪▒╪з┘Л ┘Д╪и╪╖╪з┘В╪й ┘З┘И┘К╪к┘Г ┘И╪╡┘И╪▒╪й ╪┤╪о╪╡┘К╪й.

╪л┘Е ╪г╪▒╪│┘Д ╪▒┘В┘Е ╪н╪│╪з╪и┘Г ╪е┘Д┘Й ┘Е╪п┘К╪▒┘Г ╪г┘И ┘Е╪п┘К╪▒┘Г ╪з┘Д╪▒╪ж┘К╪│┘К.
╪к┘К┘Д┘К╪м╪▒╪з┘Е: @""",

"HI": """рдирдорд╕реНрддреЗ! MobCash рдЦрд╛рддрд╛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝реЙрд░реНрдо рднрд░реЗрдВ:
1. рдкреВрд░рд╛ рдирд╛рдо:
2. рдЬрдиреНрдорддрд┐рдерд┐:
3. рдкрд╣рдЪрд╛рди рдкрддреНрд░ рд╕рдВрдЦреНрдпрд╛:
4. рд╡рд░реНрддрдорд╛рди рд╕реНрдерд╛рди:
5. рдЕрдкрдиреЗ рдкрд╣рдЪрд╛рди рдкрддреНрд░ рдХреА рдлрд╝реЛрдЯреЛ рдФрд░ рдПрдХ рд╕реЗрд▓реНрдлрд╝реА рд╕рдВрд▓рдЧреНрди рдХрд░реЗрдВред

рдлрд┐рд░ рдЕрдкрдиреА рдЦрд╛рддрд╛ рдЖрдИрдбреА рдЕрдкрдиреЗ рдкреНрд░рдмрдВрдзрдХ рдпрд╛ рдореБрдЦреНрдп рдкреНрд░рдмрдВрдзрдХ рдХреЛ рднреЗрдЬреЗрдВред
рдЯреЗрд▓реАрдЧреНрд░рд╛рдо: @""",

"BN": """рж╣рзНржпрж╛рж▓рзЛ! MobCash ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯ рждрзИрж░рж┐ ржХрж░рждрзЗ ржлрж░рзНржоржЯрж┐ ржкрзВрж░ржг ржХрж░рзБржи:
рзз. ржкрзБрж░рзЛ ржирж╛ржо:
рзи. ржЬржирзНржо рждрж╛рж░рж┐ржЦ:
рзй. ржкрж░рж┐ржЪржпрж╝ржкрждрзНрж░ ржиржорзНржмрж░:
рзк. ржмрж░рзНрждржорж╛ржи ржЕржмрж╕рзНржерж╛ржи:
рзл. ржЖржкржирж╛рж░ ржкрж░рж┐ржЪржпрж╝ржкрждрзНрж░рзЗрж░ ржЫржмрж┐ ржПржмржВ ржПржХржЯрж┐ рж╕рзЗрж▓ржлрж┐ рж╕ржВржпрзБржХрзНржд ржХрж░рзБржиред

рждрж╛рж░ржкрж░ ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯ ржЖржЗржбрж┐ ржЖржкржирж╛рж░ ржорзНржпрж╛ржирзЗржЬрж╛рж░ ржмрж╛ ржкрзНрж░ржзрж╛ржи ржмрзНржпржмрж╕рзНржерж╛ржкржХрзЗрж░ ржХрж╛ржЫрзЗ ржкрж╛ржарж╛ржиред
ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо: @"""


    },

    "support": {
        "EN": "Support contacts:\n@ultrapari_Alex",
        "RU": "╨Ъ╨╛╨╜╤В╨░╨║╤В╤Л ╨┐╨╛╨┤╨┤╨╡╤А╨╢╨║╨╕:\n@ultrapari_Alex",
        "AR": "╪п╪╣┘Е ╪з┘Д╪╣┘Е┘Д╪з╪б:\n@ultrapari_Alex",
        "HI": "рд╕рдкреЛрд░реНрдЯ рд╕рдВрдкрд░реНрдХ:\n@ultrapari_Alex",
        "BN": "рж╕рж╛ржкрзЛрж░рзНржЯ ржпрзЛржЧрж╛ржпрзЛржЧ:\n@ultrapari_Alex",
    },

    "verify": {
        "EN": "Enter manager username in format @USERNAME:",
        "RU": "╨Т╨▓╨╡╨┤╨╕╤В╨╡ ╨╕╨╝╤П ╨╝╨╡╨╜╨╡╨┤╨╢╨╡╤А╨░ ╨▓ ╤Д╨╛╤А╨╝╨░╤В╨╡ @USERNAME:",
        "AR": "╪г╪п╪о┘Д ╪з╪│┘Е ╪з┘Д┘Е╪п┘К╪▒ ╪и╪к┘Ж╪│┘К┘В @USERNAME:",
        "HI": "@USERNAME рдлреЙрд░реНрдореЗрдЯ рдореЗрдВ рдореИрдиреЗрдЬрд░ рдХрд╛ рдирд╛рдо рджрд░реНрдЬ рдХрд░реЗрдВ:",
        "BN": "@USERNAME ржлрж░ржорзНржпрж╛ржЯрзЗ ржорзНржпрж╛ржирзЗржЬрж╛рж░рзЗрж░ ржЗржЙржЬрж╛рж░ржирзЗржо рж▓рж┐ржЦрзБржи:",
    },

    "valid": {
        "EN": "тЬЕ This is our official manager. You can trust them.",
        "RU": "тЬЕ ╨н╤В╨╛ ╨╜╨░╤И ╨╝╨╡╨╜╨╡╨┤╨╢╨╡╤А, ╨▓╤Л ╨╝╨╛╨╢╨╡╤В╨╡ ╨╡╨╝╤Г ╨┤╨╛╨▓╨╡╤А╤П╤В╤М.",
        "AR": "тЬЕ ┘З╪░╪з ┘Е╪п┘К╪▒ ╪▒╪│┘Е┘К. ┘К┘Е┘Г┘Ж┘Г ╪з┘Д┘И╪л┘И┘В ╪и┘З.",
        "HI": "тЬЕ рдпрд╣ рд╣рдорд╛рд░рд╛ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рдореИрдиреЗрдЬрд░ рд╣реИред рдЖрдк рдЙрди рдкрд░ рднрд░реЛрд╕рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред",
        "BN": "тЬЕ ржПржЯрж┐ ржЖржорж╛ржжрзЗрж░ ржЕржлрж┐рж╕рж┐ржпрж╝рж╛рж▓ ржорзНржпрж╛ржирзЗржЬрж╛рж░ред ржЖржкржирж┐ рждрж╛ржХрзЗ ржмрж┐рж╢рзНржмрж╛рж╕ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред",
    },

    "invalid": {
        "EN": "тЫФя╕П This is not our manager. Contact @",
        "RU": "тЫФя╕П ╨н╤В╨╛ ╨╜╨╡ ╨╜╨░╤И ╨╝╨╡╨╜╨╡╨┤╨╢╨╡╤А. ╨б╨▓╤П╨╢╨╕╤В╨╡╤Б╤М ╤Б @",
        "AR": "тЫФя╕П ┘З╪░╪з ┘Д┘К╪│ ┘Е╪п┘К╪▒┘Ж╪з. ╪з╪к╪╡┘Д ╪и┘А @",
        "HI": "тЫФя╕П рдпрд╣ рд╣рдорд╛рд░рд╛ рдореИрдиреЗрдЬрд░ рдирд╣реАрдВ рд╣реИред @ рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░реЗрдВ",
        "BN": "тЫФя╕П ржПржЯрж┐ ржЖржорж╛ржжрзЗрж░ ржорзНржпрж╛ржирзЗржЬрж╛рж░ ржиржпрж╝ред ржпрзЛржЧрж╛ржпрзЛржЧ ржХрж░рзБржи @",
    }
}
valid_managers = ["@ultrapari_Alex", "@", "@"]

# Flask "keep-alive" ╨┤╨╗╤П Render (╤Н╨╜╨┤╨┐╨╛╨╕╨╜╤В ╨╖╨┤╨╛╤А╨╛╨▓╤М╤П)
@app.route('/health')
def health():
    return "ok"

def get_lang(chat_id):
    return user_language.get(chat_id, "EN")

def main_menu(chat_id):
    lang = get_lang(chat_id)

    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    markup.add(
        "тЬЕ " + ("Become Partner" if lang == "EN" else TEXTS["partner"][lang][:20] + "..."),
        "ЁЯТ╕ " + ("Be Payment Agent" if lang == "EN" else TEXTS["agent_choose"][lang])
    )
    markup.add(
        "ЁЯУЮ " + ("Support" if lang == "EN" else TEXTS["support"][lang][:20] + "..."),
        "ЁЯХ╡я╕П " + ("Verify Manager" if lang == "EN" else TEXTS["verify"][lang][:20] + "...")
    )
    markup.add("ЁЯМР " + ("Change Language" if lang == "EN" else TEXTS["start"][lang][:20] + "..."))

    bot.send_message(chat_id, TEXTS["menu"][lang], reply_markup=markup)

@bot.message_handler(commands=['start'])
def start(msg):
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    for code, name in LANGS.items():
        markup.add(name)
    bot.send_message(msg.chat.id, TEXTS["start"]["EN"], reply_markup=markup)

@bot.message_handler(func=lambda m: m.text in LANGS.values())
def set_language(msg):
    lang_code = [k for k, v in LANGS.items() if v == msg.text][0]
    user_language[msg.chat.id] = lang_code
    main_menu(msg.chat.id)

@bot.message_handler(func=lambda m: True)
def menu_handler(msg):
    chat_id = msg.chat.id
    lang = get_lang(chat_id)
    t = msg.text

    if t is None:
        return

    if "тЬЕ" in t:
        bot.send_message(chat_id, TEXTS["partner"][lang])
        return
    if "ЁЯТ╕" in t:
        markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
        markup.add("ЁЯПж Bank-transfer", "ЁЯУ▒ MobCash")
        markup.add("тмЕя╕П Back")
        bot.send_message(chat_id, TEXTS["agent_choose"][lang], reply_markup=markup)
        return
    if "ЁЯУЮ" in t:
        bot.send_message(chat_id, TEXTS["support"][lang])
        return
    if "ЁЯХ╡я╕П" in t:
        bot.send_message(chat_id, TEXTS["verify"][lang])
        return
    if "ЁЯМР" in t:
        markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
        for code, name in LANGS.items():
            markup.add(name)
        bot.send_message(chat_id, TEXTS["start"][lang], reply_markup=markup)
        return
    if "ЁЯПж" in t:
        bot.send_message(chat_id, TEXTS["agent_bank"][lang])
        return
    if "ЁЯУ▒" in t:
        bot.send_message(chat_id, TEXTS["agent_mobcash"][lang])
        return
    if "тмЕя╕П" in t:
        main_menu(chat_id)
        return
    if t.startswith("@"):
        valid_managers = ["@ultrapari_Alex", "@", "@"]
        if t in valid_managers:
            bot.send_message(chat_id, TEXTS["valid"][lang])
        else:
            bot.send_message(chat_id, TEXTS["invalid"][lang])
        main_menu(chat_id)
        return

# ╨Ч╨░╨┐╤Г╤Б╨║ polling (╤В╨╛╨╗╤М╨║╨╛ ╨┐╤А╨╕ ╨╖╨░╨┐╤Г╤Б╨║╨╡ ╤З╨╡╤А╨╡╨╖ python main.py)
if __name__ == "__main__":
    print("тЬЕ ╨С╨╛╤В ╨╖╨░╨┐╤Г╤Б╨║╨░╨╡╤В╤Б╤П (polling)...")
    # ╨С╨╡╤Б╨║╨╛╨╜╨╡╤З╨╜╤Л╨╣ ╤Ж╨╕╨║╨╗ ╤Б ╨░╨▓╤В╨╛-╨┐╨╡╤А╨╡╨┐╨╛╨┤╨║╨╗╤О╤З╨╡╨╜╨╕╨╡╨╝ ╨┐╤А╨╕ ╨╛╤И╨╕╨▒╨║╨░╤Е ╤Б╨╡╤В╨╕
    while True:
        try:
            bot.infinity_polling(skip_pending=True, timeout=10, long_polling_timeout=5)
        except Exception as e:
            print(f"тЪая╕П ╨Ю╤И╨╕╨▒╨║╨░ ╤Б╨╛╨╡╨┤╨╕╨╜╨╡╨╜╨╕╤П: {e}. ╨Я╨╡╤А╨╡╨┐╨╛╨┤╨║╨╗╤О╤З╨░╨╡╨╝╤Б╤П ╤З╨╡╤А╨╡╨╖ 5s...")
            time.sleep(5)
